<!DOCTYPE html>
<html>
<head>
	<title>Neshquest</title>

	<meta charset="utf-8"/>

	<style>
		html, body {
			height: 100%;
		}

		body {
			background-color: Black;
		}

		#display {
			display: flex;
			flex-direction: row;
			height: 90%;
		}

		#screen {
			height: 100%;

			flex: 0 0 30ch;

			font-size: 4.5vh;
			font-family: monospace;
			line-height: 1em;

			white-space: pre-wrap;
			word-wrap: break-word;

			color: White;
		}

		#console {
			height: 100%;
			width: 100%;

			display: flex;
			flex-direction: column;
			justify-content: space-between;

			border-left: 3px solid Grey;

			overflow: hidden;

			padding: 1em;
		}

		#console_text {
			height: 100%;

			margin-bottom: 0.5em;

			background-color: Black;
			color: White;

			font-size: 2em;
			font-family: monospace;

			white-space: pre-wrap;
			word-wrap: break-word;

			overflow-y: scroll;
		}

		
	</style>

	<script>
		window.onload = function() {
			var input;

			document.addEventListener('keydown', function(e) {
				if(e.keyCode == 37) {
					input.left = true;
				}

				if(e.keyCode == 38) {
					input.up = true;
				}

				if(e.keyCode == 39) {
					input.right = true;
				}

				if(e.keyCode == 40) {
					input.down = true;
				}
			});

			(function update () {
				var xhttp = new XMLHttpRequest();

				xhttp.onreadystatechange = function() {
					if(this.readyState == 4) {
						setTimeout(update, 250);

						if(this.status == 200) {
							var response = JSON.parse(this.responseText);

							document.getElementById("screen").innerHTML = response.screen;

							if(response.console_text != '') {
								var console_text = document.getElementById("console_text");

								console_text.innerHTML += response.console_text;

								console_text.scrollTop = console_text.scrollHeight;
							}
						}
					}
				};

				xhttp.open("POST", "/update", true);
				xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
				xhttp.send(input);
			})();
		};
	</script>
</head>

<body>
	<div id="display">
		<pre id="screen"></pre>
		<div id="console">
			<div id="console_text"></div>
			<input type="text" id="console_input">
		</div>
	</div>
</body>
</html>
